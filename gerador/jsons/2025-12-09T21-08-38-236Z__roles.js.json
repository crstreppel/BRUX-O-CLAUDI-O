{
  "caminho": "../backend/public/modules/roles",
  "arquivo": "roles.js",
  "conteudo": "document.addEventListener('DOMContentLoaded', () => {\n  const tbody = document.getElementById('roles-tbody');\n  const form = document.getElementById('form-role');\n  const formTitulo = document.getElementById('form-titulo-role');\n  const inputId = document.getElementById('role-id');\n  const inputNome = document.getElementById('role-nome');\n  const inputDescricao = document.getElementById('role-descricao');\n  const btnCancelar = document.getElementById('btn-cancelar-role');\n\n  async function carregarRoles() {\n    try {\n      const resposta = await axios.get('/roles/listar');\n      const dados = resposta.data || [];\n      tbody.innerHTML = '';\n\n      dados.forEach((item) => {\n        const tr = document.createElement('tr');\n        tr.dataset.id = item.id;\n        tr.dataset.statusId = item.statusId;\n        tr.dataset.ativo = item.ativo;\n\n        const tdId = document.createElement('td');\n        tdId.textContent = item.id;\n\n        const tdNome = document.createElement('td');\n        tdNome.textContent = item.nome;\n\n        const tdDescricao = document.createElement('td');\n        tdDescricao.textContent = item.descricao;\n\n        const tdStatus = document.createElement('td');\n        tdStatus.textContent = item.statusId != null ? item.statusId : '';\n\n        const tdAtivo = document.createElement('td');\n        const spanAtivo = document.createElement('span');\n        spanAtivo.classList.add('badge-ativo');\n        if (item.ativo) {\n          spanAtivo.classList.add('sim');\n          spanAtivo.textContent = 'Sim';\n        } else {\n          spanAtivo.classList.add('nao');\n          spanAtivo.textContent = 'NÃ£o';\n        }\n        tdAtivo.appendChild(spanAtivo);\n\n        const tdAcoes = document.createElement('td');\n        tdAcoes.classList.add('acoes');\n\n        const btnEditar = document.createElement('button');\n        btnEditar.textContent = 'Editar';\n        btnEditar.classList.add('btn-acao', 'btn-editar');\n        btnEditar.addEventListener('click', () => preencherForm(item));\n\n        const btnExcluir = document.createElement('button');\n        btnExcluir.textContent = 'Excluir';\n        btnExcluir.classList.add('btn-acao', 'btn-excluir');\n        btnExcluir.addEventListener('click', () => excluirRole(item.id));\n\n        tdAcoes.appendChild(btnEditar);\n        tdAcoes.appendChild(btnExcluir);\n\n        tr.appendChild(tdId);\n        tr.appendChild(tdNome);\n        tr.appendChild(tdDescricao);\n        tr.appendChild(tdStatus);\n        tr.appendChild(tdAtivo);\n        tr.appendChild(tdAcoes);\n\n        tbody.appendChild(tr);\n      });\n    } catch (erro) {\n      console.error('Erro ao carregar roles:', erro);\n      alert('Erro ao carregar roles.');\n    }\n  }\n\n  function limparForm() {\n    inputId.value = '';\n    inputNome.value = '';\n    inputDescricao.value = '';\n    formTitulo.textContent = 'Novo role';\n  }\n\n  function preencherForm(item) {\n    inputId.value = item.id;\n    inputNome.value = item.nome;\n    inputDescricao.value = item.descricao;\n    formTitulo.textContent = 'Editar role';\n  }\n\n  async function salvarRole(evento) {\n    evento.preventDefault();\n    const id = inputId.value;\n    const payloadBase = {\n      nome: inputNome.value.trim(),\n      descricao: inputDescricao.value.trim()\n    };\n\n    if (!payloadBase.nome || !payloadBase.descricao) {\n      alert('Preencha todos os campos.');\n      return;\n    }\n\n    try {\n      if (!id) {\n        await axios.post('/roles/criar', payloadBase);\n      } else {\n        const linha = [...tbody.querySelectorAll('tr')].find(tr => String(tr.dataset.id) === String(id));\n        const statusId = linha ? Number(linha.dataset.statusId) || 1 : 1;\n        const ativo = linha ? (linha.dataset.ativo === 'true' || linha.dataset.ativo === '1') : true;\n\n        await axios.put(`/roles/atualizar/${id}`, {\n          ...payloadBase,\n          statusId,\n          ativo\n        });\n      }\n\n      limparForm();\n      await carregarRoles();\n    } catch (erro) {\n      console.error('Erro ao salvar role:', erro);\n      const msg = erro.response && erro.response.data && erro.response.data.erro\n        ? erro.response.data.erro\n        : 'Erro ao salvar role.';\n      alert(msg);\n    }\n  }\n\n  async function excluirRole(id) {\n    if (!confirm('Confirma excluir este role?')) {\n      return;\n    }\n\n    try {\n      await axios.delete(`/roles/excluir/${id}`);\n      await carregarRoles();\n    } catch (erro) {\n      console.error('Erro ao excluir role:', erro);\n      const msg = erro.response && erro.response.data && erro.response.data.erro\n        ? erro.response.data.erro\n        : 'Erro ao excluir role.';\n      alert(msg);\n    }\n  }\n\n  form.addEventListener('submit', salvarRole);\n  btnCancelar.addEventListener('click', limparForm);\n  carregarRoles();\n});\n"
}