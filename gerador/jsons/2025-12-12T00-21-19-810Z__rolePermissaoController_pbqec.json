{
  "caminho": "../backend/modules/roles",
  "arquivo": "rolePermissaoController.js",
  "conteudo": "const Role = require('./roleModel');\nconst Permissao = require('../permissoes/permissaoModel');\nconst sequelize = require('../../config/connection');\n\nmodule.exports = {\n  async atribuirPermissao(req, res) {\n    try {\n      const { id } = req.params; \n      const { permissaoId } = req.body;\n\n      if (!permissaoId) {\n        return res.status(400).json({ erro: 'permissaoId é obrigatório.' });\n      }\n\n      const role = await Role.findByPk(id);\n      if (!role) {\n        return res.status(404).json({ erro: 'Role não encontrada.' });\n      }\n\n      const permissao = await Permissao.findByPk(permissaoId);\n      if (!permissao) {\n        return res.status(404).json({ erro: 'Permissão não encontrada.' });\n      }\n\n      await role.addPermissoes(permissao);\n\n      return res.json({ mensagem: 'Permissão atribuída com sucesso.' });\n    } catch (err) {\n      return res.status(500).json({ erro: err.message });\n    }\n  },\n\n  async removerPermissao(req, res) {\n    try {\n      const { id } = req.params;\n      const { permissaoId } = req.body;\n\n      if (!permissaoId) {\n        return res.status(400).json({ erro: 'permissaoId é obrigatório.' });\n      }\n\n      const role = await Role.findByPk(id);\n      if (!role) {\n        return res.status(404).json({ erro: 'Role não encontrada.' });\n      }\n\n      const permissao = await Permissao.findByPk(permissaoId);\n      if (!permissao) {\n        return res.status(404).json({ erro: 'Permissão não encontrada.' });\n      }\n\n      await role.removePermissoes(permissao);\n\n      return res.json({ mensagem: 'Permissão removida com sucesso.' });\n    } catch (err) {\n      return res.status(500).json({ erro: err.message });\n    }\n  },\n\n  async listarPermissoes(req, res) {\n    try {\n      const { id } = req.params;\n\n      const role = await Role.findByPk(id, {\n        include: [{ model: Permissao, as: 'permissoes' }]\n      });\n\n      if (!role) {\n        return res.status(404).json({ erro: 'Role não encontrada.' });\n      }\n\n      return res.json({\n        role: role.nome,\n        permissoes: role.permissoes || []\n      });\n\n    } catch (err) {\n      return res.status(500).json({ erro: err.message });\n    }\n  }\n};\n"
}