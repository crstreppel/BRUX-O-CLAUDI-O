[
  {
    "caminho": "../backend/public/modules/shared",
    "arquivo": "api.js",
    "conteudo": "// PBQE-C â€¢ API Fetch Centralizado (RBAC correto: 401 â‰  403)\nasync function apiFetch(url, options = {}) {\n  const token = Session.getToken();\n\n  const headers = Object.assign({}, options.headers || {}, {\n    'Content-Type': 'application/json'\n  });\n\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n\n  const response = await fetch(url, { ...options, headers });\n\n  // ğŸ” Logout APENAS se nÃ£o autenticado\n  if (response.status === 401 && token) {\n    Session.logout();\n    return;\n  }\n\n  const data = await response.json();\n\n  // ğŸš« 403 = autenticado sem permissÃ£o (nÃ£o derruba sessÃ£o)\n  if (!response.ok) {\n    throw data;\n  }\n\n  return data;\n}\n\nwindow.apiFetch = apiFetch;\n"
  }
]
