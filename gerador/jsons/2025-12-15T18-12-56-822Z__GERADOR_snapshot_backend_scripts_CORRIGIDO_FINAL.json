[
  {
    "caminho": "Projeto_Petropolitan_v2/backend/scripts",
    "arquivo": "snapshot_sistema.js",
    "conteudo": "const { execSync } = require('child_process');\nconst { Client } = require('pg');\nconst fs = require('fs');\nconst path = require('path');\n\nconst OUTPUT_FILE = path.join(\n  'C:\\\\Users\\\\Claudio\\\\Desktop\\\\petropolitan\\\\sistema_Petropolian\\\\Petropolitan_Lab',\n  'snapshot_petropolitan_lab.txt'\n);\n\n// Cabe\u00e7alho com quebra correta para Windows\nfs.writeFileSync(\n  OUTPUT_FILE,\n  '=== SNAPSHOT PETROPOLITAN LAB ===\\\\r\\\\n\\\\r\\\\n',\n  'utf8'\n);\n\nfunction log(title, content) {\n  fs.appendFileSync(OUTPUT_FILE, `\\\\r\\\\n=== ${title} ===\\\\r\\\\n`, 'utf8');\n  fs.appendFileSync(OUTPUT_FILE, content + '\\\\r\\\\n', 'utf8');\n}\n\n// Script mora em backend/scripts\n// Alvos est\u00e3o em backend/modules e backend/public\nconst modulesPath = path.join(process.cwd(), '..', 'modules');\nconst publicPath  = path.join(process.cwd(), '..', 'public');\n\ntry {\n  const treeModules = execSync(\n    `cmd /c chcp 65001>nul & tree /A /F \"${modulesPath}\"`,\n    { encoding: 'utf8' }\n  );\n  log('TREE backend/modules', treeModules);\n} catch (err) {\n  log('ERRO TREE backend/modules', err.message);\n}\n\ntry {\n  const treePublic = execSync(\n    `cmd /c chcp 65001>nul & tree /A /F \"${publicPath}\"`,\n    { encoding: 'utf8' }\n  );\n  log('TREE backend/public', treePublic);\n} catch (err) {\n  log('ERRO TREE backend/public', err.message);\n}\n\n(async () => {\n  const client = new Client({\n    user: 'bruxao',\n    host: 'localhost',\n    database: 'petropolitan_lab',\n    password: 'bruxao123',\n    port: 5432\n  });\n\n  try {\n    await client.connect();\n\n    const res = await client.query(`\n      SELECT table_schema, table_name\n      FROM information_schema.tables\n      WHERE table_type = 'BASE TABLE'\n        AND table_schema NOT IN ('pg_catalog', 'information_schema')\n      ORDER BY table_schema, table_name;\n    `);\n\n    const tables = res.rows\n      .map(t => `${t.table_schema}.${t.table_name}`)\n      .join('\\\\r\\\\n');\n\n    log('TABELAS DO BANCO petropolitan_lab', '\\\\r\\\\n' + tables + '\\\\r\\\\n');\n\n  } catch (err) {\n    log('ERRO BANCO', err.message);\n  } finally {\n    await client.end();\n  }\n})();"
  }
]