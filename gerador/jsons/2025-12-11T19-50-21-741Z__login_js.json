{
  "caminho": "../backend/public/modules/login/",
  "arquivo": "login.js",
  "conteudo": "const API_BASE = \"/api/usuarios\";\n\nfunction setMessageLogin(msg, type = \"info\") {\n  const el = document.getElementById(\"msgLogin\");\n  if (!el) return;\n  el.textContent = msg || \"\";\n  el.className = \"auth-message \" + (msg ? `is-${type}` : \"\");\n}\n\nasync function postJSON(url, payload) {\n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload || {})\n  });\n  const data = await response.json().catch(() => ({}));\n  return { ok: response.ok, status: response.status, data };\n}\n\nasync function handleLogin(event) {\n  event.preventDefault();\n  const form = event.target;\n  const email = form.email?.value?.trim();\n  const senha = form.senha?.value || \"\";\n\n  if (!email || !senha) {\n    setMessageLogin(\"Informe e-mail e senha.\", \"error\");\n    return;\n  }\n\n  setMessageLogin(\"Autenticando...\", \"info\");\n\n  try {\n    const { ok, data, status } = await postJSON(`${API_BASE}/login`, { email, senha });\n\n    if (!ok) {\n      setMessageLogin(data.erro || `Falha no login (HTTP ${status}).`, \"error\");\n      return;\n    }\n\n    if (!data.sucesso) {\n      setMessageLogin(data.erro || \"Não foi possível autenticar.\", \"error\");\n      return;\n    }\n\n    if (!data.emailVerificado) {\n      setMessageLogin(\"E-mail não confirmado. Verifique seu e-mail.\", \"warn\");\n      return;\n    }\n\n    sessionStorage.setItem(\"usuarioAtual\", email.toLowerCase());\n    setMessageLogin(\"Login efetuado! Redirecionando...\", \"success\");\n    window.location.href = \"/painel\";\n  } catch {\n    setMessageLogin(\"Erro interno ao autenticar.\", \"error\");\n  }\n}\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n  const form = document.getElementById(\"formLogin\");\n  if (form) form.addEventListener(\"submit\", handleLogin);\n});\n"
}