[
  {
    "caminho": "..",
    "arquivo": "Projeto_Petropolitan_v2/backend/scripts/snapshot_sistema.js",
    "conteudo": "const { execSync } = require('child_process');\nconst { Client } = require('pg');\nconst fs = require('fs');\nconst path = require('path');\n\n// Corrige a base: Gerador roda em /gerador,\n// precisamos voltar um n\u00edvel e entrar em Projeto_Petropolitan_v2/backend/scripts\nconst BASE_BACKEND_SCRIPTS = path.resolve(__dirname, '..', 'Projeto_Petropolitan_v2', 'backend', 'scripts');\n\nconst OUTPUT_FILE = path.join(\n  'C:\\\\Users\\\\Claudio\\\\Desktop\\\\petropolitan\\\\sistema_Petropolian\\\\Petropolitan_Lab',\n  'snapshot_petropolitan_lab.txt'\n);\n\n// garante que estamos no lugar certo\nprocess.chdir(BASE_BACKEND_SCRIPTS);\n\n// Header limpo\nfs.writeFileSync(OUTPUT_FILE, '=== SNAPSHOT PETROPOLITAN LAB ===\\r\\n\\r\\n', 'utf8');\n\nfunction section(title) {\n  fs.appendFileSync(\n    OUTPUT_FILE,\n    `\\r\\n==============================\\r\\n${title}\\r\\n==============================\\r\\n`,\n    'utf8'\n  );\n}\n\nfunction write(content) {\n  fs.appendFileSync(OUTPUT_FILE, content + '\\r\\n', 'utf8');\n}\n\n// Paths corretos (a partir de backend/scripts)\nconst modulesPath = path.join('..', 'modules');\nconst publicPath  = path.join('..', 'public');\n\ntry {\n  section('TREE backend/modules');\n  const treeModules = execSync(`cmd /c chcp 65001>nul & tree /A /F \"${modulesPath}\"`, { encoding: 'utf8' });\n  write(treeModules.trim());\n} catch (err) {\n  write('ERRO TREE backend/modules: ' + err.message);\n}\n\ntry {\n  section('TREE backend/public');\n  const treePublic = execSync(`cmd /c chcp 65001>nul & tree /A /F \"${publicPath}\"`, { encoding: 'utf8' });\n  write(treePublic.trim());\n} catch (err) {\n  write('ERRO TREE backend/public: ' + err.message);\n}\n\n(async () => {\n  const client = new Client({\n    user: 'bruxao',\n    host: 'localhost',\n    database: 'petropolitan_lab',\n    password: 'bruxao123',\n    port: 5432\n  });\n\n  try {\n    await client.connect();\n\n    section('TABELAS DO BANCO petropolitan_lab');\n\n    const res = await client.query(`\n      SELECT table_schema, table_name\n      FROM information_schema.tables\n      WHERE table_type = 'BASE TABLE'\n        AND table_schema NOT IN ('pg_catalog', 'information_schema')\n      ORDER BY table_schema, table_name;\n    `);\n\n    res.rows.forEach(t => {\n      write(`- ${t.table_schema}.${t.table_name}`);\n    });\n\n  } catch (err) {\n    write('ERRO BANCO: ' + err.message);\n  } finally {\n    await client.end();\n  }\n})();"
  }
]