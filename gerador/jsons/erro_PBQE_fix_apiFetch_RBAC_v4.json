[
  {
    "caminho": "../backend/public/modules/shared",
    "arquivo": "api.js",
    "conteudo": "// PBQE-C â€¢ API Fetch Centralizado (RBAC correto: 401 â‰  403)
async function apiFetch(url, options = {}) {
  const token = Session.getToken();

  const headers = Object.assign({}, options.headers || {}, {
    'Content-Type': 'application/json'
  });

  if (token) {
    headers['Authorization'] = `Bearer ${token}`;
  }

  const response = await fetch(url, { ...options, headers });

  // ğŸ” Logout APENAS se NÃƒO autenticado
  if (response.status === 401 && token) {
    Session.logout();
    return;
  }

  const data = await response.json();

  // ğŸš« 403 = autenticado sem permissÃ£o (nÃ£o derruba sessÃ£o)
  if (!response.ok) {
    throw data;
  }

  return data;
}

window.apiFetch = apiFetch;
"
  }
]
